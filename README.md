# 广告设置系统

基于Vue2 + Element UI的广告内容排版设计工具，支持图片、视频、文字等多种媒体元素的可视化编排，以及播放任务的管理和调度。

## 功能模块

### 1. 广告设计器 ⭐ 已增强
- **图片组件**：支持多张图片轮播，可设置切换间隔、显示方式（等比例居中/拉伸填充）
- **视频组件**：支持视频播放，可设置自动播放、循环播放、显示方式
- **文字组件**：支持多文本轮播、滚动效果、字体样式设置
- **容器组件**：基础容器，可设置背景色、透明度等
- **拖拽设计**：直观的拖拽操作界面，所见即所得
- **属性面板**：位置、尺寸、样式精确控制
- **画布管理**：自定义屏幕尺寸，实时缩放适配
- **节目保存** ⭐ 新增：将设计保存为节目，可在播放设置中关联使用

### 2. 播放设置 ⭐ 新增
- **播放任务管理**：添加、编辑、删除播放任务
- **设备配置**：支持精确匹配、前缀匹配、全部设备三种SN匹配方式
- **时间控制**：设置有效期、每日播放时间、周期（周一至周日）
- **节目关联**：将节目与播放任务关联
- **状态管理**：启用/停用任务，实时切换
- **搜索筛选**：按任务名称、设备SN、状态筛选

### 3. JSON预览 ⭐ 新增
- **设备请求模拟**：模拟设备请求播放列表（7001接口）
- **数据预览**：查看完整的JSON响应数据
- **通知日志**：实时查看7002变更通知
- **数据复制**：一键复制JSON用于测试

## 技术栈

- **前端框架**：Vue 2.5.2
- **UI组件库**：Element UI 2.15.13
- **构建工具**：Webpack
- **开发语言**：JavaScript ES6+
- **Mock数据**：内置Mock API服务

## 快速开始

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## 使用指南

📖 **详细文档**：

**节目保存功能** ⭐ 新增：
- [节目保存功能说明](./节目保存功能说明.md) - 如何将设计保存为节目并关联到播放设置

**播放设置相关**：
- [播放设置功能说明](./PLAY_SCHEDULE_README.md) - 播放任务管理详细说明
- [快速开始指南](./QUICK_START.md) - 播放设置快速上手
- [功能演示说明](./功能演示说明.md) - 演示流程和验证点
- [功能开发总结](./播放设置功能总结.md) - 开发总结和技术要点

**广告设计相关**：
- [视频格式常见问题](./VIDEO_FORMAT_FAQ.md) - 为什么推荐 MP4？其他格式可以用吗？
- [视频功能使用指南](./VIDEO_GUIDE.md) - 视频格式、转换工具、常见问题
- [浏览器格式支持详解](./VIDEO_FORMAT_SUPPORT.md) - 各浏览器对视频格式的支持情况
- [动画效果指南](./ANIMATION_GUIDE.md) - 文字滚动、图片轮播等动画效果
- [滚动测试指南](./SCROLL_TEST_GUIDE.md) - 文字滚动功能测试
- [问题排查指南](./TROUBLESHOOTING.md) - 常见问题解决方案

### 广告设计器使用

### 1. 设置画布
1. 在左侧组件库中设置屏幕尺寸
2. 可选择预设分辨率或自定义尺寸
3. 画布会自动缩放以适应编辑区域

### 2. 添加元素
1. 从左侧组件库拖拽组件到画布
2. 图片/视频组件会自动弹出文件选择对话框
3. 文字组件可直接双击编辑内容

### 3. 调整属性
1. 点击选中画布中的元素
2. 在右侧属性面板中调整各种属性
3. 支持位置、尺寸、样式、内容等设置

### 4. 预览和保存
1. 点击"预览"按钮查看最终效果
2. 点击"保存设计"将配置保存到本地存储
3. 点击"下发到设备"可推送到广告终端

## 组件详解

### 图片组件
- **多图轮播**：支持添加多张图片，自动轮播显示
- **显示方式**：等比例居中或拉伸填充
- **切换间隔**：可设置图片切换时间间隔（毫秒）

### 视频组件
- **视频播放**：支持 MP4(H.264)、WebM、OGG 格式
- **播放控制**：自动播放、循环播放设置
- **显示方式**：等比例居中或拉伸填充
- **格式要求**：推荐使用 MP4 格式，H.264 编码，文件大小 < 50MB
- **详细说明**：查看 [视频功能使用指南](./VIDEO_GUIDE.md)

### 文字组件
- **多文本轮播**：支持多个文本内容轮播显示
- **对齐方式**：左对齐、居中、右对齐、滚动
- **滚动效果**：可设置滚动速度（1-9级）
- **字体样式**：字体大小、颜色、加粗等

### 容器组件
- **基础容器**：可作为其他元素的背景
- **样式设置**：背景色、透明度、边框等

## 数据格式

生成的JSON配置包含以下结构：

```json
{
  "canvas": {
    "width": 1920,
    "height": 1080
  },
  "elements": [
    {
      "id": 1,
      "type": "image",
      "x": 100,
      "y": 100,
      "width": 300,
      "height": 200,
      "images": [
        {
          "url": "data:image/...",
          "name": "image1.jpg"
        }
      ],
      "displayMode": "center",
      "interval": 3000,
      "opacity": 255,
      "zIndex": 1
    }
  ]
}
```

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 11+
- Edge 16+

## 开发说明

## 项目结构

```
src/
├── components/
│   ├── AdDesigner.vue          # 广告设计器组件
│   ├── PlaySchedule.vue        # 播放设置组件 ⭐ 新增
│   ├── PlayListViewer.vue      # JSON预览组件 ⭐ 新增
│   ├── elements/               # 元素组件
│   │   ├── ContainerElement.vue
│   │   ├── ImageElement.vue
│   │   ├── VideoElement.vue
│   │   └── TextElement.vue
│   └── properties/             # 属性面板组件
│       ├── ContainerProperties.vue
│       ├── ImageProperties.vue
│       ├── VideoProperties.vue
│       ├── TextProperties.vue
│       └── CanvasProperties.vue
├── services/
│   └── mockApi.js              # Mock API服务 ⭐ 新增
├── router/
│   └── index.js                # 路由配置
└── main.js
```

## 接口说明

### 7001 - 获取播放任务列表
设备请求播放列表，平台返回适用的播放任务。

### 7002 - 播放任务变更通知
播放任务变更时，平台推送通知到相关设备。

详细接口定义请查看 [需求文档.md](./需求文档.md)

## 扩展开发

### 添加新组件类型
1. 在`elements/`目录下创建新的元素组件
2. 在`properties/`目录下创建对应的属性组件
3. 在`AdDesigner.vue`中注册新组件

### 接入真实API
1. 替换`src/services/mockApi.js`中的Mock实现
2. 使用axios或fetch进行HTTP请求
3. 配置API基础URL和认证

### MQTT集成
1. 安装MQTT客户端库
2. 实现7002通知的实际推送
3. 监听设备在线状态

## 许可证

MIT License

## 更新日志

### v1.2.0 ⭐ 最新
- 新增节目保存功能
- 广告设计器支持保存为节目
- 节目可在播放设置中关联使用
- 自动转换设计元素为节目格式
- 支持节目名称管理

### v1.1.0
- 新增播放设置模块
- 新增JSON预览功能
- 实现Mock API服务
- 支持SN匹配（精确/前缀/全部）
- 支持周期性播放设置
- 支持7001/7002接口模拟

### v1.0.0
- 初始版本发布
- 支持图片、视频、文字、容器四种基础组件
- 实现拖拽设计、属性编辑、预览功能
- 支持多媒体轮播和动画效果